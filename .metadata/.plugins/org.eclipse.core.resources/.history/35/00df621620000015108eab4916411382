package ca.effpro.learn.hadoop.mr.tpt.exer1;

import java.io.DataInput;
import java.io.DataOutput;
import java.io.IOException;

import org.apache.hadoop.io.IntWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.io.WritableComparable;

/**
 * A custom writable class which will be composed of the following items
 * <ol> year
 * <ol> month
 * <ol> infraction code
 * 
 * 
 */
public class YearMonthToInfractionWritable implements WritableComparable<YearMonthToInfractionWritable>{

	
	private IntWritable year;
	private Text month;
	private Text infractionCode;
	
	public YearMonthToInfractionWritable(String p$yearMonth, String p$infractionCode) {
		year = new IntWritable(Integer.parseInt(p$yearMonth.substring(0,3)));
		month = new Text(p$yearMonth.substring(4));
		infractionCode = new Text(p$infractionCode);
	}
	
	public YearMonthToInfractionWritable(IntWritable p$year, Text p$month, Text p$infractionCode) {
		year = p$year;
		month = p$month ;
		infractionCode = p$infractionCode;
	}
	
	public int compareTo(YearMonthToInfractionWritable o) {
		// TODO Auto-generated method stub
		return 0;
	}
	
	
	public void readFields(DataInput din) throws IOException {
		year.readFields(din);
		month.readFields(din);
		infractionCode.readFields(din);
		
	}

	public void write(DataOutput dout) throws IOException {
		year.write(dout);
		month.write(dout);
		infractionCode.write(dout);
	}

	

}
