package ca.effpro.learn.hadoop.mr.tpt.exer1;

import org.apache.commons.lang.StringUtils;
import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.apache.hadoop.io.Text;
import org.junit.Assert;
import org.junit.Test;

public class YearGroupComparatorTest {
	private static final Log logger = LogFactory
			.getLog(YearPartionerTest.class);

	@Test
	public void test$getPartion() {
		
		String[][] params = new String[][]{
			new String[] {"20080108","01","20080108","0"},
			new String[] {"20080108","01","20080208","0"},
			new String[] {"20080108","01","20090208","1"},
			
		};
		
		
		YearMonthToInfractionWritable writable = new YearMonthToInfractionWritable();
		YearPartioner partioner = new YearPartioner();
		
		for(String[] param : params) {
			logger.info("=> " + StringUtils.join(param,","));
			
			writable.set(param[0], param[1]);
			
			int partion = partioner.getPartition(writable, new Text("XYX"), Integer.parseInt(param[2]));
			Assert.assertEquals(param[3], "" + partion);
			
		}
		
	}
}